spring:
  application:
    name: checkfood-service-test

  datasource:
    url: jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1
    driverClassName: org.h2.Driver
    username: sa
    password:

  jpa:
    database-platform: org.hibernate.dialect.H2Dialect
    hibernate:
      ddl-auto: create-drop # Pro testy chceme čistou DB
    show-sql: false # Doporučuji false, pokud nechceš mít konzoli zaplavenou SQL
    properties:
      hibernate:
        format_sql: true

  # --- PŘIDÁNO: Dummy Mail Konfigurace ---
  # Musí tu být, aby Spring nekřičel, že mu chybí proměnné
  mail:
    host: localhost
    port: 1025
    username: test-sender@checkfood.cz  # Toto se injektuje do EmailService
    password: test-password
    properties:
      mail:
        smtp:
          auth: false
          starttls:
            enable: false

  # DŮLEŽITÉ: Vypneme Flyway migrace
  # Protože používáme 'ddl-auto: create-drop', Hibernate vytvoří tabulky sám.
  # Kdyby běžel i Flyway, hádaly by se o to, kdo vytvoří tabulky.
  flyway:
    enabled: false

security:
  jwt:
    # Testovací klíč (musí být stejně dlouhý jako v produkci - 256bit)
    secret: 404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970
    access-token-expiration-seconds: 3600
    refresh-token-expiration-seconds: 86400
    issuer: checkfood-test

# Vypneme rate limiting pro testy (aby nám nepadaly testy při rychlém opakování)
# Předpokládá to, že máš v RateLimitFilter podmínku na profil nebo property
# Pokud ne, nevadí, limity v AuthControlleru jsou dost vysoké.